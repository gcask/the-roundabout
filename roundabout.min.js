function showPlayer(t){return State.isHighlighted(t)?m("mark",m("strong",t.toUpperCase())):t}let State={teams:[],ones:[],twos:[],highlighted:"(none)",load:function(t){return m.request({method:"GET",url:t}).then(function(t){State.teams=t.teams,State.ones=t.ones,State.twos=t.twos})},isHighlighted:t=>State.highlighted==t,highlight:function(t){State.highlighted=t}};const trophyIcon=()=>m.trust("&#x1F3C6;"),zapIcon=()=>m.trust("&#x26A1;"),Standings={view:function(t){const e={ONES:9,TWOS:5,THREES:45};let o=State.teams.map(t=>({members:t.members,ones:0,twos:0,threes:0,total:function(){return this.ones+this.twos+this.threes}}));for(const t of State.ones)for(const m of t)if("score"in m){let t=m.players[m.score[0]>m.score[1]?0:1];const s=o.findIndex(e=>e.members.includes(t));o[s].ones+=e.ONES}for(const t of State.twos){let m=t.pairs[t.score[0]>t.score[1]?0:1][0];const s=o.findIndex(t=>t.members.includes(m));o[s].twos+=e.TWOS}o.sort((t,e)=>{const o=t.total(),m=e.total();return o==m?t.threes==e.threes?t.twos==e.twos?t.ones<e.ones:t.twos<e.twos:e.threes<t.threes:o<m});let s=0,n=0,r=0;return o.forEach((t,e)=>{t.ones>o[s].ones&&(s=e),t.twos>o[n].twos&&(n=e),t.threes>o[r].threes&&(r=e)}),m(".column",m("table.table.table-striped.table-hover",[m("thead",m("tr",[m("th",{colspan:4},"Team"),m("th.text-right","1v1"),m("th.text-right","2v2"),m("th.text-right","3v3"),m("th.text-right","Total")])),m("tbody",o.map((t,e)=>m("tr",m("td",0==e?m("strong",trophyIcon(),e+1):e+1),t.members.map(t=>m("td",showPlayer(t))),m("td.text-right",e==s&&t.ones>0?m("strong",trophyIcon(),t.ones):t.ones),m("td.text-right",e==n&&t.twos>0?m("strong",trophyIcon(),t.twos):t.twos),m("td.text-right",e==r&&t.threes>0?m("strong",trophyIcon(),t.threes):t.threes),m("td.text-right",0==e?m("strong",trophyIcon(),t.total()):t.total())))),m("caption",m("h1","Standings"))]))}},Team={view:function(t){return m(".card.team",[m(".card-header",m("h2.card-title",showPlayer(t.attrs.members[0]))),m("ul.card-body",t.attrs.members.slice(1).map(t=>m("li",showPlayer(t)))),m(".card-footer")])}},Teams={view:function(t){return[m("section.columns",State.teams.map(t=>m(".column.col-lg-3.col-md-6.col-sm-12",m(Team,t)))),m("section.columns",m(Standings))]}},Threes={view:function(t){const e=State.teams.slice(1),o=State.teams.slice(0,-1);return m(".columns",[m(".column",[m("table.table",[m("caption",m("h2","First Bo3")),m("thead.text-center",m("tr",[m("th"),o.map(t=>m("th",showPlayer(t.members[0])))])),m("tbody",e.map((t,e)=>m("tr",[m("th",showPlayer(t.members[0])),o.map((t,o)=>m("td",{class:e<o?"bg-gray":""}))])))])])])}},Twos={view:function(t){const e=[[0,1],[0,2],[1,2]],o=State.teams.slice(1),s=State.teams.slice(0,-1);return m(".columns",[m(".column.col-12",[m("table.table.table-scroll",[m("caption",m("h2","Round-robin Bo3")),m("thead.text-center",m("tr",[m("th",{colspan:2}),s.map(t=>m("th",{colspan:3},["Team ",showPlayer(t.members[0])]))]),m("tr",[m("th",{colspan:2}),s.map(t=>e.map(e=>m("th",[showPlayer(t.members[e[0]])," ",showPlayer(t.members[e[1]])])))])),o.map((t,o)=>m("tbody",e.map((n,r)=>{let a=[];const l=t.members[n[0]],c=t.members[n[1]];return 0==r&&a.push(m("th",{rowspan:3},["Team ",showPlayer(l)])),a.push(m("th",[showPlayer(l)," ",showPlayer(c)])),a.push(...s.map((t,s)=>e.map(e=>{const n=t.members[e[0]],r=t.members[e[1]];let a=void 0,i=-1,h=-1;const u=()=>o<s?{class:"bg-gray"}:[l,c,n,r].some(State.isHighlighted)?{class:"bg-secondary text-center"}:{class:"text-center"};if(o>=s){const t=[l,c,n,r];a=State.twos.find(e=>e.pairs.flat().every(e=>t.includes(e))),a&&(i=a.pairs.findIndex(t=>t.includes(l)),h=(i+1)%2)}return m("td",u(),a?a.score[i]+" - "+a.score[h]:"")}))),m("tr",a)})))])])])}},Ones={view:function(t){return m(".columns",[m(".column.col-12",[m("table.table.table-striped",[m("thead",[m("tr",[m("th"),State.ones.map((t,e)=>m("th.text-center",{colspan:2},"Round "+(e+1)))]),m("tr",[m("th","Player"),State.ones.map(()=>[m("th.text-center","Opponent"),m("th.text-center","Result")])])]),m("tbody",State.teams.map(t=>[t.members.map(t=>m("tr",State.isHighlighted(t)?{class:"bg-secondary"}:{},[m("td",showPlayer(t)),State.ones.map(e=>{const o=e.find(e=>e.players.includes(t)),s=o.players.indexOf(t),n=(s+1)%2;return[m("td.text-center",showPlayer(o.players[n])),m("td.text-center","score"in o?o.score[s]+" - "+o.score[n]:"")]})]))]))])])])}},Schedule={view:function(t){return m(".columns",[m("section.column.col-6.col-md-12",[m(".columns",[m(".column",this.ones())])]),m("section.column.col-6.col-md-12",[m(".columns",[m(".column",this.twos())])])])},ones:function(){const t=(State.ones.length>0?State.ones[State.ones.length-1]:[]).filter(t=>!("score"in t));return[m("h2","1v1"),m("ul",t.map(t=>m("li",[showPlayer(t.players[0]),zapIcon(),showPlayer(t.players[1])])))]},twos:function(){let t=[];if(State.teams.length>1){let e={};for(let t=0;t<State.teams.length;++t)e[t]=[[0,1],[0,2],[1,2]];for(let o=0;o<State.teams.length-1;++o){const m=State.teams[o];for(const s of e[o]){const n=m.members[s[0]],r=m.members[s[1]];let a=!1;for(let m=o+1;m<State.teams.length&&!a;++m){const o=State.teams[m];let s=e[m];for(let l=0;l<s.length&&!a;++l){const c=s[l],i=o.members[c[0]],h=o.members[c[1]],u=[n,r,i,h];State.twos.some(t=>t.pairs.flat().every(t=>u.includes(t)))||(t.push([[n,r],[i,h]]),e[m].splice(l,1),a=!0)}}}}}return[m("h2","2v2"),t.map(t=>m(".columns",[m(".column.col-2.col-lg-auto",showPlayer(t[0][0])),m(".column.col-1.hide-xl",m.trust("&amp;")),m(".column.col-2.col-lg-auto",showPlayer(t[0][1])),m(".column.col-2.col-lg-auto.text-center",zapIcon()),m(".column.col-2.col-lg-auto",showPlayer(t[1][0])),m(".column.col-1.hide-xl",m.trust("&amp;")),m(".column.col-2.col-lg-auto",showPlayer(t[1][1])),m(".column.hide-md.divider")]))]}},App={oninit:function(t){State.load(t.attrs.dataUrl)},view:function(t){const e=function(t){return State.isHighlighted(t)?{value:t,selected:!0}:{value:t}},o=function(t){return{class:"btn-lg btn btn-"+(m.route.get()==t?"primary":"link"),href:t}};return[m("header.navbar",[m("section.navbar-section",[m("strong.navbar-brand.mr-2","The Roundabout"),m(m.route.Link,o("/teams"),"Teams")]),m("section.navbar-center",[m(m.route.Link,o("/3s"),"3v3"),m(m.route.Link,o("/2s"),"2v2"),m(m.route.Link,o("/1s"),"1v1"),m(m.route.Link,o("/schedule"),"Schedule")]),m("section.navbar-section",[m(".input-group.input-inline",[m("select.form-select",{onchange:function(t){State.highlight(t.target.value)}},[m("option",e("(none)"),"(no player highlighted)"),State.teams.map(t=>t.members.map(t=>m("option",e(t),t)))])])])]),m(".container",t.children)]}};